## `rate` - mutation rates and Ka/Ks calculations

These scripts are used to calculate callable sites as well as
Ka/Ks values across datasets.

- Get mutation rate summaries per sample - `calculate_rate.py`

Uses mutation tables generated by `filtering/mut_describer.py` and provided
generation estimates to return per-sample mutation rates as well as mutation
counts and callables (for summary statistic calculations). 

Usage: 

```bash
# can optionally take in generation_file/generation_count arguments
python calculate_rate.py \
--mut_table path/to/mut/describer/outfile \
--callables_table path/to/all/callables \
--vcf path/to/vcf \
--out path/to/outfile
```

- Generate table of callable sites - `callable_sites.py`

Counts and generates table of callable sites per chromosome per sample using
sample GVCFs. This table is required for all other scripts in this directory.

Usage:

```bash
python callable_sites.py \
--gvcf_dir path/to/gvcfs/ \
--out callables.tsv
```

- Get syn + nonsyn callable sites

This is initially encompassed by `callable_sites_degeneracy.py` (genome-wide), 
`callable_genes_degeneracy.py` (for provided genes). Uses callables
table generated above as well as annotation table (for fold degeneracy).
`syn_mut_count.py` returns counts of S and NS mutations from `mut_describer.py`
output. 

Usage:

```bash
python syn_mut_count.py \
--mut_table path/to/mut/describer/outfile \
--gene_list path/to/gene/list \ # tsv format with genes as first col
--out path/to/outfile
```

- Mutation rate analysis - `rate_overall.Rmd`

Notebook that uses mutation counts and callables files to get SNM/indel rates.

- Calculate Ka/Ks across datasets - `ka_ks.Rmd`

Notebook that uses output files generated from the scripts above
to calculate and compare Ka/Ks between datasets. 
